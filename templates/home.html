{% extends "base.html" %}
{% block head %}
	<title>Untitled Travels</title>
	<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script>
      $(function() {
        $("#startdate").datepicker();
		$("#enddate").datepicker();
      });
    </script>
	<style>#map {
        height: 400px;
		width: 400px;
		margin-left: auto;
		margin-right: auto;
      }</style>
{% endblock %}

{% block content %}
	<script>
	function myFunction() {
	  var x = document.getElementById("advancesearch");
	  if (x.style.display == "none") {
		x.style.display = "block";
	  } else {
		x.style.display = "none";
	  }
	  console.log(document.getElementById("map"));
	  
	}
	</script>
	
    <p> <img src = "/static/nsw1.png"  > </p>
	<form name = 'search' method = 'POST' >
		<input type = "text" placeholder = "Search..">
		<button type = "submit">Submit</button>
		<br><br>
		<p><button type = "button" onclick="myFunction()">Advance Search</button></p>
		<div id = advancesearch style = "display:none;">
			Start date: <input type="text" id="startdate" name = "startdate">
			End date: <input type="text" id="enddate" name = "enddate">
			Beds: <input type= "number" name = "beds" max = "5" min = "1">
			Bathrooms: <input type= "number" name = "bathrooms" max  = "5" min = "1" >
			Parking Spaces: <input type= "number" name = "parking" max  = "3" min = "0" >
			<br><br><br>
			Location:
			<input type = "hidden" name = "location" id = "hiddenlocation">
			<br>
			Distance Radius:<output name="radiusrange" id="radiusrange">100</output> m
			<br>
			<input type = "range" name= "distance" id = "radiuschange" min = "100" max = "2000" value = "100" oninput = "changeCircle(this.value)">
			<div id="map"></div>
		<div >	
	</form>
	
    <script>
		var map;
		var markerlist = [];
		var circlelist = [];
	
		function initMap() {
			map = new google.maps.Map(document.getElementById('map'), {
			  center: {lat: -33.91538902145825 , lng: 151.11207767686824},
			  zoom: 13
			});
			google.maps.event.addListener(map, 'click', function( event ){
				document.getElementById("hiddenlocation").value = event.latLng.lat()+", "+event.latLng.lng();
				
				for (i = 0;i<markerlist.length;i++){
					markerlist[i].setMap(null);
					circlelist[i].setMap(null);
				}
				var marker = new google.maps.Marker({position: event.latLng, map: map});
				markerlist.push(marker)
				var circle = new google.maps.Circle({map: map, radius: parseInt(document.getElementById("radiuschange").value), fillColor: '#AA0000'});
				circle.bindTo('center', marker, 'position');
				circlelist.push(circle)
			});
			
		}
		function changeCircle(newval){
			document.getElementById("radiusrange").value = newval;
			for (i = 0;i<circlelist.length;i++){
				if(circlelist[i]==null)
					continue;
				circlelist[i].setRadius(parseInt(newval));
			}
		}
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDwnoTrb4bDrnE2qSu7q1HiS0pWCsCJS7g&callback=initMap"
    async defer></script>
{% endblock %}
